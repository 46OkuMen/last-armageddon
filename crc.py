import binascii
from array import array

poly = 0x8001801B

table = array('L')
for byte in range(256):
    crc = 0
    for bit in range(8):
        if (byte ^ crc) & 1:
            crc = (crc >> 1) ^ poly
        else:
            crc >>= 1
        byte >>= 1
    table.append(crc)

def crc32(string):
    value = 0x00000000
    for ch in string:
        value = table[(ch ^ value) & 0xff] ^ (value >> 8)

    return -1 - value

# test

data = (
    b'',
    b'test',
    b'hello world',
    b'1234',
    b'A long string to test CRC32 functions',
    b'\x00\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF\x00\x09\x16\x72\x01\xA9\x03\x85\x0D\x64\x0F\xA9\x63\x85\x04\xA9\xAB\x85\x05\x4C\x5C\x34\x20\x92\x88\x20\x6D\x81\x20\x16\x40\xC2\x64\x0E\xB1\x20\xC9\xFF\xF0\x02\x44\x36\xC8\xC0\x08\xD0\xF3\xA5\x0E\xD0\x06\x20\x77\x88\x4C\x9B\x7F\x44\xC6\x90\x03\x4C\x9B\x7F\x85\x0F\xAA\xBD\x7B\xAB\xAC\x8C\xAB\x99\x95\xAB\xC9\x11\xB0\x0D\x20\xD4\x44\xAE\x8C\xAB\x95\x2D\x90\x03\x4C\x9B\x7F\x4C\xDC\x7F\x5A\xA6\x0E\x9D\x7B\xAB\x0A\xA8\x8A\x0A\xAA\xB9\x39\x5B\x9D\x63\xAB\xB9\x3A\x5B\x9D\x64\xAB\xE6\x0E\x7A\x60\x60\x44\xFD\x62\x20\xAB\x3B\xA2\x0F\xA0\x02\xA9\x0C\x85\x1B\x85\x1A\x20\xC5\x33\x20\xE6\x80\xA2\x10\xA0\x03\x20\x9B\x3B\x20\x6D\x81\x20\x3D\x41\xA2\x10\xA0\x04\x20\x9B\x3B\xA9\x7E\x85\x00\xA9\x81\x85\x01\x20\xDC\x3A\xA9\x10\x85\x0C\xA9\x05\x85\x0D\xA9\x08\x85\x0E\xAE\x8C\xAB\xBD\x91\xAB\x85\x0F\xA9\x86\x85\x04\xA9\x81\x85\x05\x20\x5C\x34\x90\x02\x80\xDD\xAE\x8C\xAB\xC9\x07\xF0\x04\x9D\x91\xAB\x60\xBD\x91\xAB\x8D\x74\x81\xA9\x07\x9D\x91\xAB\x60\xAD\x8C\xAB\xF0\x73\xA2\x0F\xA0\x0E\xA9\x0C\x85\x1B\xA9\x08\x85\x1A\x20\xC5\x33\x9C\x73\x81\xAD\x73\x81\x20\xDD\x6A\xF0\x4D\xAD\x73\x81\x20\x47\x3F\x20\xB2\x3F\x29\x7F\xC9\x04\xB0\x3E\xAE\x73\x81\xBC\x75\x81\xA2\x10\x20\x9B\x3B\xAD\x73\x81\x20\x47\x3F\x20\x3D\x41\xAE\x73\x81\xBC\x75\x81\xC8\xBD\x91\xAB\xAA\xBD\x77\x81\x18\x69\x11\xAA\x20\x9B\x3B\xAE\x73\x81\xBD\x91\xAB\x0A\xAA\xBD\x86\x81\x85\x00\xBD\x87\x81\x85\x01\x20\xDC\x3A\xEE\x73\x81\xAD\x8C\xAB\xCD\x73\x81\xD0\xA0\x60\xA9\x0F\x85\x0A\xA9\x0E\x85\x0B\xA2\x0C\xA0\x08\x4C\x34\x34\xAD\x8C\xAB\x4C\x47\x3F\x00\x00\x0F\x11\x13\x00\x06\x00\x05\x03\x05\xCA\xC4\xDE\xB3\xBD\xD9\x3F\x00\x96\x81\x9C\x81\xA6\x81\xAA\x81\xB4\x81\xB8\x81\xBF\x81\xC4\x81\xBC\xDE\xC4\xDE\xB3\x00\xBE\xAF\xB7\xDD\xBA\xB3\xB9\xDE\xB7\x00\xCF\xCE\xB3\x00\x53\x70\x65\x63\x69\x61\x6C\x20\x20\x00\xB8\xBD\xD8\x00\xCE\xDE\xB3\xB7\xDE\xAE\x00\xC6\xB9\xDE\xD9\x00\xC3\xB2\xBE\xB2\x00\x9C\x84\x87\x9C\x85\x87\xAE\x83\x87\xBD\x2D\xAB\xC9\xFF\xF0\x2C\xAE\x82\x87\xBC\x95\xAB\xB9\x12\xAC\x85\x20\x8D\x84\x87\x64\x21\x9C\x85\x87\xAE\x82\x87\xAC\x83\x87\x20\x33\x86\xAD\x84\x87\x85\x20\xAD\x85\x87\x85\x21\xAD\x83\x87\x20\xBF\x84\xAD\x84\x87\x85\x1A\xAD\x85\x87\x85\x1B\x60\x20\x18\x86\x20\x60\x3F\x20\x01\x84\xA5\xF8\x8D\x84\x87\xA5\xF9\x8D\x85\x87\x20\x18\x86\x20\x7E\x3F\x20\x01\x84\x18\xAD\x84\x87\x65\xF8\x8D\x84\x87\xAD\x85\x87\x65\xF9\x8D\x85\x87\xA9\x03\x85\x1A\x64\x1B\x20\x7C\x35\x20\x12\x84\x20\x18\x86\x20\xB7\x40\x85\x1A\x64\x1B\x20\x12\x84\x20\x18\x86\x20\xE1\x40\x85\xF8\x64\xF9\xA9\x05\x85\xFA\x64\xFB\x20\x7B\x3A\x18\xAD\x84\x87\x65\xF8\x8D\x84\x87\xAD\x85\x87\x65\xF9\x8D\x85\x87\xAD\x82\x87\x20\x2C\x84\x18\xAD\x84\x87\x65\x1A\x8D\x84\x87\xAD\x85\x87\x65\x1B\x8D\x85\x87\xAD\x82\x87\xD0\x32\x20\x18\x86\x20\xE9\x40\x85\xF8\x20\x18\x86\x20\x59\x3F\x18\x65\xF8\x85\xF8\x62\x69\x00\x85\xF9\xA9\x03\x85\xFA\x64\xFB\x20\x7B\x3A\x18\xAD\x84\x87\x65\xF8\x8D\x84\x87\xAD\x85\x87\x65\xF9\x8D\x85\x87\xAD\x83\x87\x20\xFA\x76\xC2\xB1\x1A\x85\xF8\xC8\xB1\x1A\x85\xF9\x20\x18\x86\x20\x60\x3F\x38\xA5\xF8\xE5\x1A\xA5\xF9\xE5\x1B\xB0\x1E\x20\x18\x86\x20\xF1\x40\x85\x1A\x64\x1B\x20\x01\x84\x18\xAD\x84\x87\x65\xF8\x8D\x84\x87\xAD\x85\x87\x65\xF9\x8D\x85\x87\x20\x18\x86\x0A\xAA\xBD\xD9\x27\x85\x1A\xBD\xDA\x27\x85\x1B\x20\x01\x84\x20\x18\x86\x20\x60\x3F\x38\xA5\xF8\xE5\x1A\xA5\xF9\xE5\x1B\x90\x24\x20\x18\x86\x20\x9D\x3F\x85\xF8\x64\xF9\xA9\x05\x85\xFA\x64\xFB\x20\x7B\x3A\x18\xAD\x84\x87\x65\xF8\x8D\x84\x87\xAD\x85\x87\x65\xF9\x8D\x85\x87\xAD\x83\x87\x20\xFA\x76\xA0\x04\xB1\x1A\x85\xF8\xC8\xB1\x1A\x85\xF9\x20\x09\x84\xA5\xF8\x85\x1A\xA5\xF9\x85\x1B\x20\x12\x84\xA9\x03\x85\x1A\x64\x1B\x20\x7C\x35\x20\x12\x84\xA9\x03\x85\x1A\x64\x1B\x20\x7C\x35\x18\xAD\x84\x87\x65\x1A\x8D\x84\x87\x62\x6D\x85\x87\x8D\x85\x87\xAD\x83\x87\x20\xFA\x76\xA0\x06\xB1\x1A\x85\xF8\x64\xF9\x20\x09\x84\xA5\xF8\x85\x1A\xA5\xF9\x85\x1B\x20\x12\x84\xA9\x03\x85\x1A\x64\x1B\x20\x7C\x35\x20\x12\x84\xA9\x03\x85\x1A\x64\x1B\x20\x7C\x35\x18\xAD\x84\x87\x65\x1A\x8D\x84\x87\x62\x6D\x85\x87\x8D\x85\x87\xAD\x84\x87\x85\x20\xAD\x85\x87\x85\x21\xAE\x82\x87\xAC\x83\x87\x20\x33\x86\xAD\x84\x87\x85\x20\xAD\x85\x87\x85\x21\xAD\x83\x87\x20\xBF\x84\xAD\x84\x87\x85\x1A\xAD\x85\x87\x85\x1B\x60\xA5\x1A\x85\xF8\xA5\x1B\x85\xF9\xA9\x0A\x85\xFA\x64\xFB\x4C\x7B\x3A\x38\xAD\x84\x87\xE5\x1A\x8D\x84\x87\xAD\x85\x87\xE5\x1B\x8D\x85\x87\xB0\x06\x9C\x84\x87\x9C\x85\x87\x60\x64\x1B\x64\x1A\x20\x47\x3F\x8D\x8B\xAB\xC9\x02\xF0\x04\xC9\x01\xD0\x09\xA9\x01\x20\x1F\x33\x90\x02\xE6\x1B\xAD\x8B\xAB\x20\xC6\x3F\xC2\xB1\x20\xC9\xFF\xF0\x1F\x89\x80\xF0\x1B\x29\x7F\xAA\xBD\xFD\xAB\x18\x65\x1A\x85\x1A\x62\x65\x1B\x85\x1B\xAD\x8B\xAB\xC9\x07\xF0\x3B\xC9\x0B\xF0\x2D\xC8\xC0\x03\xD0\xD6\xAD\x8B\xAB\xC9\x06\xF0\x01\x60\xC2\xA2\x03\xB1\x20\xC9\xFF\xF0\x05\x89\x80\xF0\x01\x60\xC8\xCA\xD0\xF1\xAD\x85\x87\x18\x6A\x85\x1B\xAD\x84\x87\x6A\x85\x1A\x60\xE0\x03\x90\xCF\xE0\x06\xB0\xCB\x80\x04\xE0\x03\xB0\xC5\xBD\xFD\xAB\x18\x6A\x18\x65\x1A\x85\x1A\x62\x65\x1B\x85\x1B\x80\xB4\x48\x20\xFA\x76\xC2\xB1\x1A\x38\xE5\x20\x91\x1A\xC8\xB1\x1A\xE5\x21\x91\x1A\x90\x09\xB1\x1A\x88\x11\x1A\xF0\x02\x68\x60\x18\xC2\xB1\x1A\x65\x20\x8D\x84\x87\xC8\xB1\x1A\x65\x21\x8D\x85\x87\x62\x91\x1A\x88\x91\x1A\xA0\x08\xB1\x1A\x18\x6D\x87\xAB\x8D\x87\xAB\xC8\xB1\x1A\x6D\x88\xAB\x8D\x88\xAB\x62\x6D\x89\xAB\x8D\x89\xAB\x68\xAA\xA9\xFF\x9D\x2D\xAB\x9D\x53\xAB\x9D\x5B\xAB\xE0\x04\xB0\x29\x8A\x18\x69\x04\xA8\xB9\x2D\xAB\x9D\x2D\xAB\xB9\x53\xAB\x9D\x53\xAB\xB9\x5B\xAB\x9D\x5B\xAB\xA9\xFF\x99\x2D\xAB\x99\x53\xAB\x99\x5B\xAB\xBD\x2D\xAB\xC9\xFF\xD0\x56\xA9\x01\x85\xF7\x8D\x00\x00\x8A\x0A\x69\x41\x85\x00\x62\x69\x69\x85\x01\x02\xA0\x01\xB1\x00\x02\x85\x03\x64\x02\x46\x03\x66\x02\x46\x03\x66\x02\xB2\x00\x18\x65\x02\x85\x02\x62\x65\x03\x85\x03\xE3\x02\x20\x02\x00\x02\x00\xA9\x02\x85\xF7\x8D\x00\x00\xF3\x02\x00\x00\x20\x02\x00\xA2\x04\x06\x00\x26\x01\xCA\xD0\xF9\xA9\x1F\x20\xA8\x76\x4C\xCF\x86\x98\x85\x01\x0A\x85\x00\x0A\x0A\x18\x65\x00\x65\x01\x85\x00\x18\xA9\xA5\x65\x00\x85\x00\x62\x69\xAB\x85\x01\x8A\x85\x03\x0A\x85\x02\x0A\x0A\x18\x65\x02\x65\x03\x85\x02\x18\xA9\xA5\x65\x02\x85\x02\x62\x69\xAB\x85\x03\xC2\xB1\x00\x91\x02\xC8\xC0\x0B\xD0\xF7\xDA\x20\x49\x85\xFA\x8A\x0A\xAA\xBD\x10\x86\x85\x00\xBD\x11\x86\x85\x01\xA2\x06\xDA\xA5\x00\x85\x02\xA5\x01\x85\x03\xE6\x02\xD0\x02\xE6\x03\x20\x39\x77\xE6\x00\xD0\x02\xE6\x01\xFA\xCA\xD0\xE4\x60\x81\x00\x01\x02\x81\x03\x01\x05\xAD\x82\x87\x4C\x47\x3F\xAE\x80\x87\xAC\x81\x87\xCA\x88\xA9\x0D\x85\x1B\xA9\x06\x85\x1A\x20\xC5\x33\x80\x6D\x5A\xDA\xA9\x14\x8D\x80\x87\x98\x29\x03\xAA\xBD\x86\x87\x8D\x81\x87\x44\xD8\xFA\x8A\x20\x47\x3F\x20\x3D\x41\xA5\x20\x05\x21\xF0\x58\xA9\xCA\x20\x28\x3B\x44\x45\x7A\x5A\xB9\x2D\xAB\x20\xEA\x68\xA9\xC6\x20\x28\x3B\x44\x36\xA5\x20\x85\x00\xA5\x21\x85\x01\x20\xFF\x3A\xA9\xC9\x20\x28\x3B\x44\x24\xA9\x74\x85\x00\xA9\x87\x85\x01\x20\xDC\x3A\x20\x22\x36\x7A\x98\x29\x03\xAA\xBD\x86\x87\x3A\x85\x0B\xA9\x13\x85\x0A\xA2\x0D\xA0\x06\x4C\x34\x34\xAE\x80\x87\xAC\x81\x87\xEE\x81\x87\x4C\x9B\x3B\x44\xF2\xA9\x65\x85\x00\xA9\x87\x85\x01\x20\xDC\x3A\x44\xE5\x7A\x5A\xB9\x2D\xAB\x20\xEA\x68\x44\xDB\xA9\x6D\x85\x00\xA9\x87\x85\x01\x80\xB5\x44\x39\xA9\x06\x85\x0B\xA9\x06\x85\x0A\x20\x7B\xE0\x44\x6F\xC6\x0A\xD0\xFA\xC6\x0B\xD0\xEF\x44\x22\x20\x7B\xE0\xA9\x06\x85\x0B\xA9\x06\x85\x0A\x20\x7B\xE0\xA2\x10\x9C\x02\x00\x9C\x03\x00\xCA\xD0\xF7\xC6\x0A\xD0\xF1\xC6\x0B\xD0\xE6\x60\xA9\x01\x85\xF7\x8D\x00\x00\xA9\x80\x8D\x02\x00\xA9\x0A\x8D\x03\x00\xA9\x02\x85\xF7\x8D\x00\x00\xF3\x02\x00\x83\x20\x20\x00\xA9\x01\x85\xF7\x8D\x00\x00\xE3\x00\x20\x02\x00\x02\x00\xA9\x00\x85\xF7\x8D\x00\x00\xE3\x00\x20\x02\x00\x02\x00\xA9\x02\x85\xF7\x8D\x00\x00\x60\x82\xAD\x02\x00\x35\x83\x8D\x02\x00\xE8\xAD\x03\x00\x35\x83\x8D\x03\x00\xE8\xE0\x20\xD0\xEA\x60\xC9\xBA\xB3\xB9\xDE\xB7\xCA\x00\xC6\xB6\xDC\xBB\xDA\xC0\x00\x80\x9E\x92\x70\x7C\x9E\xA6\xB1\xC0\xB4\xC0\x00\x00\x00\x00\x00\x00\x00\x03\x09\x0F\x15\x20\x92\x88\xAD\x8C\xAB\x20\x47\x3F\x20\x24\x40\x64\x0E\xC2\xB1\x20\xC9\xFF\xF0\x02\x44\x7C\xC8\xC0\x0C\xD0\xF3\xA5\x0E\xD0\x08\x20\x77\x88\x20\x9E\x88\x38\x60\xA9\x12\x85\x0C\xA9\x03\x85\x0D\x64\x0F\xA9\x63\x85\x04\xA9\xAB\x85\x05\x20\x5C\x34\xB0\xE4\x85\x0F\xAA\xBD\x7B\xAB\xAE\x8C\xAB\x9D\x95\xAB\xAE\x8C\xAB\xBD\x95\xAB\xC9\x1C\xF0\x2C\xA6\x0F\xBD\xF7\x54\xC9\x04\xB0\x30\xAE\x8C\xAB\xBD\x95\xAB\xC9\x15\xF0\x26\xC9\x0F\x90\x08\xC9\x12\x90\x11\xC9\x16\xB0\x0D\x20\xB8',
)

for s in data:
    #print(repr(s))
    a = binascii.crc32(s)
    print('%08x' % (a & 0xffffffff))
    b = crc32(s)
    print('%08x' % (b % 0xffffffff))
    print("")